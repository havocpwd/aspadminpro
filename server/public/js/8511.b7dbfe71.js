(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[8511],{3697:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return T}});var r=s(7650),a=s(3381),n=s(2503),i=s(7294),l=s(9088),o=s(3328),d=s(3206),u=s(2515),c=s(9007),h=s(2732),p=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"mt-4"},[t(n.Z,{staticClass:"elevation-1",attrs:{headers:e.headers,options:e.tableOptions,"footer-props":{"items-per-page-options":[15,30,50,100,-1]},items:e.orders,"items-per-page":15,loading:e.loading,"loading-text":"Loading... Please wait","single-expand":e.singleExpand,expanded:e.expanded,"show-expand":""},on:{"update:expanded":function(t){e.expanded=t}},scopedSlots:e._u([{key:"item.actions",fn:function({item:s}){return[t(l.Z,{staticClass:"mr-2",attrs:{small:""}},[e._v("mdi-printer")]),t(l.Z,{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editOrder(s)}}},[e._v("mdi-pencil")])]}},{key:"top",fn:function(){return[t(h.Z,{attrs:{flat:""}},[t(o.Z,{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:r}){return[t(c.Z,e._g(e._b({attrs:{label:"Periode","prepend-icon":"mdi-calendar",readonly:"",rounded:""},model:{value:e.dateRangeText,callback:function(t){e.dateRangeText=t},expression:"dateRangeText"}},"v-text-field",r,!1),s))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[t(i.Z,{attrs:{range:""},on:{change:e.getdataorders},model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}},[t(u.Z),t(a.Z,{attrs:{text:"",color:"primary"},on:{click:function(t){e.menu=!1}}},[e._v(" Cancel ")]),t(a.Z,{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.menu.save(e.dates)}}},[e._v(" OK ")])],1)],1),t(u.Z),t(r.Z,{attrs:{"prepend-icon":"mdi-account-clock",label:"Customer",items:e.customers,"item-text":e.getNameCustomers,"item-value":"id",dense:""},on:{change:e.getdataorders},model:{value:e.partnerSelected,callback:function(t){e.partnerSelected=t},expression:"partnerSelected"}}),t(a.Z,{attrs:{color:"primary",dark:"",icon:""},on:{click:e.printSalesReport}},[t(l.Z,[e._v("mdi-printer")])],1)],1)]},proxy:!0},{key:"expanded-item",fn:function({headers:s,item:r}){return[t("td",{attrs:{colspan:s.length}},[t("div",{staticClass:"mt-4"},[t(d.Z,{attrs:{dense:""},scopedSlots:e._u([{key:"default",fn:function(){return[t("thead",[t("tr",[t("th",{staticClass:"text-left"},[e._v("Keyname")]),t("th",{staticClass:"text-left"},[e._v("Description")]),t("th",{staticClass:"text-left"},[e._v("Qty")]),t("th",{staticClass:"text-left"},[e._v("Cogs")]),t("th",{staticClass:"text-left"},[e._v("Harga")]),t("th",{staticClass:"text-left"},[e._v("Total")])])]),t("tbody",e._l(r.orderDetail,(function(s){return t("tr",{key:s.id},[t("td",[e._v(e._s(s.products[0].keyname))]),t("td",[e._v(e._s(s.shortDesc))]),t("td",[e._v(e._s(s.qtyOrdered))]),t("td",[e._v(e._s(s.cogs))]),t("td",[e._v(e._s(s.unitPrice))]),t("td",[e._v(e._s(s.total))])])})),0)]},proxy:!0}],null,!0)})],1)])]}}],null,!0)})],1)])},m=[],f=s(4226),g=s(3245),y=s(6727),v=s.n(y),x=s(7920),I=s(9649);v().vfs=x.I.vfs;var S={data:()=>({expanded:[],getAllOrder:!1,singleExpand:!1,loading:!1,menu:!1,dates:["2019-09-10","2019-09-20"],tableOptions:{itemsPerPage:30},headers:[{text:"No",value:"index",class:"primary"},{text:"Order No",align:"start",value:"orderNo",class:"primary"},{text:"Date Issued",value:"dateIssued",class:"primary"},{text:"Customer",value:"partner",class:"primary"},{text:"deliverTo",value:"deliverTo",class:"primary"},{text:"Note",value:"note",class:"primary"},{text:"Total",value:"total",class:"primary"},{text:"Status",value:"docStatus",class:"primary"},{text:"Actions",value:"actions",sortable:!1,class:"primary"}],orders:[],purchaseorders:[],dateStart:new Date,dateEnd:new Date,partnerSelected:{},customers:[]}),computed:{dateRangeText(){return this.dates.join(" ~ ")}},mounted(){this.retrieveCustomers(),this.getPeriodeDate()},methods:{getPeriodeDate(){let e=new Date;e.setDate(24);let t=new Date;e.getDate()>=t.getDate()&&e.getMonth()==t.getMonth()?(this.dateStart.setDate(24),this.dateStart.setMonth(this.dateStart.getMonth()-1),this.dateEnd.setDate(this.dateStart.getDate()+30),this.dateEnd.setMonth(this.dateEnd.getMonth()-1)):(this.dateStart.setDate(24),this.dateEnd.setDate(this.dateStart.getDate()+30),this.dateEnd.setMonth(this.dateEnd.getMonth())),this.dates=[this.dateStart.toISOString().substring(0,10),this.dateEnd.toISOString().substring(0,10)]},getdataorders(){this.retrieveorders(),this.retrieveopurchaserders()},retrieveorders(){0===Object.keys(this.partnerSelected).length?console.log("Pilih customers terlebih dahulu"):f.Z.getOrderByPartner(this.dates[0],this.dates[1],this.partnerSelected).then((e=>{this.loading=!1,this.orders=e.data.orders.map(this.getDisplay),console.log(this.orders)})).catch((e=>{console.log(e)}))},retrieveopurchaserders(){0===Object.keys(this.partnerSelected).length?console.log("Pilih customers terlebih dahulu"):f.Z.getPurchaseOrderByPartner(this.dates[0],this.dates[1],this.partnerSelected).then((e=>{this.loading=!1,this.purchaseorders=e.data.orders.map(this.getDisplay),console.log(this.purchaseorders)})).catch((e=>{console.log(e)}))},getDisplay(e,t){return{index:t+1,id:e._id,orderNo:e.orderNo,dateIssued:this.$moment(e.dateIssued,"YYYY-MM-DD").format("LL"),partner:e.partners.first_name+" "+e.partners.last_name,deliverTo:e.deliverTo,deliveryFee:e.deliveryFee,discount:e.discount,note:e.note,payment:e.payments.desc,docStatus:e.docStatus,total:e.total,orderDetail:e.orderdetails}},retrieveCustomers(){g.Z.getAll().then((e=>{this.customers=e.data.partners}))},getNameCustomers(e){return`${e.first_name} ${e.last_name}`},async printSalesReport(){const e=await I.createSalesReport(this.orders,this.purchaseorders,this.dates),t=await v().createPdf(e);t.open()}}},D=S,b=s(1001),C=(0,b.Z)(D,p,m,!1,null,null,null),T=C.exports},9649:function(e,t){t.createSalesReport=async(e,t,s)=>{function r(e){return"Rp. "+e.toFixed().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}let a=[],n=[];function i(e){for(var t=0,s=0;s<e.length;s++)t+=e[s].total;return t}function l(e){var t=["orderNo","dateIssued","partner","deliverTo","shortDesc","qtyOrdered","unitPrice","total"],s=[];return s.push([{fillColor:"#3A4D8F",text:"Order No",style:"tableHeader"},{fillColor:"#3A4D8F",text:"Tanggal",style:"tableHeader"},{fillColor:"#3A4D8F",text:"Pelanggan",style:"tableHeader"},{fillColor:"#3A4D8F",text:"dikirim ke",style:"tableHeader"},{fillColor:"#3A4D8F",text:"Nama Barang",style:"tableHeader"},{fillColor:"#3A4D8F",text:"QTY",style:"tableHeader"},{fillColor:"#3A4D8F",text:"Harga",style:"tableHeader"},{fillColor:"#3A4D8F",text:"Total",style:"tableHeader"}]),e.forEach((function(e){var r=[];t.forEach((function(t){r.push({text:e[t].toString(),style:"contentleft",fontSize:8})})),s.push(r)})),s}e.forEach((function(e){var t={};let s=new Date(e.dateIssued);t.dateIssued=s.toLocaleDateString("en-US",{day:"numeric",month:"numeric",year:"numeric"}),t.deliverTo=e.deliverTo,t.deliveryFee=e.deliveryFee,t.discount=e.discount,t.note=e.note,t.orderNo=e.orderNo,t.partner=e.partner,t.payment=e.payment,t.total=e.total,t.orderDetail=e.orderDetail,a.push(t)})),t.forEach((function(e){var t={};let s=new Date(e.dateIssued);t.dateIssued=s.toLocaleDateString("en-US",{day:"numeric",month:"numeric",year:"numeric"}),t.deliverTo=e.deliverTo,t.deliveryFee=e.deliveryFee,t.discount=e.discount,t.note=e.note,t.orderNo=e.orderNo,t.partner=e.partner,t.payment=e.payment,t.total=e.total,t.orderDetail=e.orderDetail,n.push(t)})),detailOrdersData=a.flatMap((({orderNo:e,dateIssued:t,partner:s,deliverTo:r,orderDetail:a})=>a.map((a=>({orderNo:e,dateIssued:t,partner:s,deliverTo:r,...a}))))),detailPOrdersData=n.flatMap((({orderNo:e,dateIssued:t,partner:s,deliverTo:r,orderDetail:a})=>a.map((a=>({orderNo:e,dateIssued:t,partner:s,deliverTo:r,...a})))));let o=[];a.forEach((function(e,t){var s={};s.no=t+1,s.dateIssued=e.dateIssued,s.deliverTo=e.deliverTo,s.deliveryFee=e.deliveryFee,s.discount=e.discount,s.note=e.note,s.orderNo=e.orderNo,s.partner=e.partner,s.payment=e.payment,s.grandTotal=r(e.total),o.push(s)}));let d=[];function u(e){var t=i(a),s=["no","orderNo","dateIssued","partner","deliverTo","grandTotal"],n=[];return n.push([{fillColor:"#3A4D8F",text:"No",style:"tableHeader"},{fillColor:"#3A4D8F",text:"No Invoice",style:"tableHeader"},{fillColor:"#3A4D8F",text:"Tanggal",style:"tableHeader"},{fillColor:"#3A4D8F",text:"Pelanggan",style:"tableHeader"},{fillColor:"#3A4D8F",text:"dikirim ke",style:"tableHeader"},{fillColor:"#3A4D8F",text:"Total Invoice",style:"tableHeader"}]),e.forEach((function(e){var t=[];s.forEach((function(s){t.push({text:e[s].toString(),style:"contentleft",fontSize:9})})),n.push(t)})),n.push([{colSpan:5,text:"Total :",style:"subheader"},"","","","",{text:r(t),style:"subheader"}]),n}function c(e){var t=i(n),s=["no","orderNo","dateIssued","partner","deliverTo","grandTotal"],a=[];return a.push([{fillColor:"#3A4D8F",text:"No",style:"tableHeader"},{fillColor:"#3A4D8F",text:"No Invoice",style:"tableHeader"},{fillColor:"#3A4D8F",text:"Tanggal",style:"tableHeader"},{fillColor:"#3A4D8F",text:"Supplier",style:"tableHeader"},{fillColor:"#3A4D8F",text:"dikirim ke",style:"tableHeader"},{fillColor:"#3A4D8F",text:"Total Invoice",style:"tableHeader"}]),e.forEach((function(e){var t=[];s.forEach((function(s){t.push({text:e[s].toString(),style:"contentleft",fontSize:9})})),a.push(t)})),a.push([{colSpan:5,text:"Total :",style:"subheader"},"","","","",{text:r(t),style:"subheader"}]),a}function h(e,t){let s=0;return s=e-t,s}n.forEach((function(e,t){var s={};s.no=t+1,s.dateIssued=e.dateIssued,s.deliverTo=e.deliverTo,s.deliveryFee=e.deliveryFee,s.discount=e.discount,s.note=e.note,s.orderNo=e.orderNo,s.partner=e.partner,s.payment=e.payment,s.grandTotal=r(e.total),d.push(s)}));let p={content:[{columns:[{text:"Laporan Piutang Pelanggan",style:"header"},{text:"Periode : "+s,style:"subheader"}]},{style:"tableExample",table:{headerRows:1,widths:["auto","auto","auto","auto","auto","auto","auto","*"],body:l(detailOrdersData)}},{text:" "},{style:"tableExample",table:{headerRows:1,widths:["auto","auto","auto","auto","auto","*"],body:u(o)},layout:{hLineWidth:function(e,t){return 0===e||t.table.body.length,1},vLineWidth:function(e,t){return 0===e||t.table.widths.length,1},hLineColor:function(e,t){return"grey"},vLineColor:function(e,t){return"grey"},fillColor:function(e,t,s){return e%2===0?"#CCCCCC":null}}},{text:""},{text:""},{text:"hutang",bold:!0,style:"contentup"},{style:"tableExample",table:{headerRows:1,widths:["auto","auto","auto","auto","auto","*"],body:c(d)},layout:{hLineWidth:function(e,t){return 0===e||t.table.body.length,1},vLineWidth:function(e,t){return 0===e||t.table.widths.length,1},hLineColor:function(e,t){return"grey"},vLineColor:function(e,t){return"grey"},fillColor:function(e,t,s){return e%2===0?"#CCCCCC":null}}},{style:"tableExample",table:{headerRows:1,widths:["*","*","*","*","*"],body:[[{colSpan:4,text:"Grand Total",bold:!0,style:"subheader"},"","","",{text:r(h(i(a),i(n))),style:"subheader"}]]},layout:{hLineWidth:function(e,t){return 0===e||t.table.body.length,1},vLineWidth:function(e,t){return 0===e||t.table.widths.length,1},hLineColor:function(e,t){return"grey"},vLineColor:function(e,t){return"grey"},fillColor:function(e,t,s){return e%2===0?"#CCCCCC":null}}},{text:"* Laporan ini dibuat berdasarkan dengan data yang sudah masuk kedalam system.",style:"small"}],styles:{header:{fontSize:12,bold:!0,color:"#3A4D8F",margin:[0,0,0,30]},subheader:{fontSize:10,alignment:"right",margin:[0,0,0,1]},contentleft:{fontSize:10,margin:[0,2,0,2]},contentup:{fontSize:10,bold:!0,margin:[0,30,0,0]},superMargin:{margin:[20,0,40,0],fontSize:15},small:{fontSize:8,margin:[0,40,40,20],italics:!0},tableExample:{margin:[0,0,0,0]},tableHeader:{bold:!0,fontSize:10,color:"white"}}};return p}},3245:function(e,t,s){"use strict";var r=s(3390);class a{getAll(){return r.Z.get("/customers")}get(e){return r.Z.get(`/customers/${e}`)}create(e){return r.Z.post("/customers",e)}update(e,t){return r.Z.put(`/customers/${e}`,t)}delete(e){return r.Z["delete"](`/customers/${e}`)}deleteAll(){return r.Z["delete"]("/customers")}findByName(e){return r.Z.get(`/customers?name=${e}`)}}t["Z"]=new a},4226:function(e,t,s){"use strict";var r=s(3390);class a{getOrdersReports(e,t){return r.Z.get(`reports/orders?start=${e}&end=${t}`)}getPurchaseOrdersReports(e,t){return r.Z.get(`reports/purchaseorders?start=${e}&end=${t}`)}getOrderByPartner(e,t,s){return r.Z.get(`reports/customersorders?start=${e}&end=${t}&id=${s}`)}getPurchaseOrderByPartner(e,t,s){return r.Z.get(`reports/customerspurchaseorders?start=${e}&end=${t}&id=${s}`)}}t["Z"]=new a},7650:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var r=s(3156),a=s(9007),n=s(7559),i=s(8131);const l={...r.l,offsetY:!0,offsetOverflow:!0,transition:!1};var o=r.Z.extend({name:"v-autocomplete",props:{allowOverflow:{type:Boolean,default:!0},autoSelectFirst:{type:Boolean,default:!1},filter:{type:Function,default:(e,t,s)=>s.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())>-1},hideNoData:Boolean,menuProps:{type:r.Z.options.props.menuProps.type,default:()=>l},noFilter:Boolean,searchInput:{type:String}},data(){return{lazySearch:this.searchInput}},computed:{classes(){return{...r.Z.options.computed.classes.call(this),"v-autocomplete":!0,"v-autocomplete--is-selecting-index":this.selectedIndex>-1}},computedItems(){return this.filteredItems},selectedValues(){return this.selectedItems.map((e=>this.getValue(e)))},hasDisplayedItems(){return this.hideSelected?this.filteredItems.some((e=>!this.hasItem(e))):this.filteredItems.length>0},currentRange(){return null==this.selectedItem?0:String(this.getText(this.selectedItem)).length},filteredItems(){return!this.isSearching||this.noFilter||null==this.internalSearch?this.allItems:this.allItems.filter((e=>{const t=(0,i.qF)(e,this.itemText),s=null!=t?String(t):"";return this.filter(e,String(this.internalSearch),s)}))},internalSearch:{get(){return this.lazySearch},set(e){this.lazySearch!==e&&(this.lazySearch=e,this.$emit("update:search-input",e))}},isAnyValueAllowed(){return!1},isDirty(){return this.searchIsDirty||this.selectedItems.length>0},isSearching(){return this.multiple&&this.searchIsDirty||this.searchIsDirty&&this.internalSearch!==this.getText(this.selectedItem)},menuCanShow(){return!!this.isFocused&&(this.hasDisplayedItems||!this.hideNoData)},$_menuProps(){const e=r.Z.options.computed.$_menuProps.call(this);return e.contentClass=`v-autocomplete__content ${e.contentClass||""}`.trim(),{...l,...e}},searchIsDirty(){return null!=this.internalSearch&&""!==this.internalSearch},selectedItem(){return this.multiple?null:this.selectedItems.find((e=>this.valueComparator(this.getValue(e),this.getValue(this.internalValue))))},listData(){const e=r.Z.options.computed.listData.call(this);return e.props={...e.props,items:this.virtualizedItems,noFilter:this.noFilter||!this.isSearching||!this.filteredItems.length,searchInput:this.internalSearch},e}},watch:{filteredItems:"onFilteredItemsChanged",internalValue:"setSearch",isFocused(e){e?(document.addEventListener("copy",this.onCopy),this.$refs.input&&this.$refs.input.select()):(document.removeEventListener("copy",this.onCopy),this.blur(),this.updateSelf())},isMenuActive(e){!e&&this.hasSlot&&(this.lazySearch=null)},items(e,t){t&&t.length||!this.hideNoData||!this.isFocused||this.isMenuActive||!e.length||this.activateMenu()},searchInput(e){this.lazySearch=e},internalSearch:"onInternalSearchChanged",itemText:"updateSelf"},created(){this.setSearch()},destroyed(){document.removeEventListener("copy",this.onCopy)},methods:{onFilteredItemsChanged(e,t){if(e!==t){if(!this.autoSelectFirst){const s=t[this.$refs.menu.listIndex];s?this.setMenuIndex(e.findIndex((e=>e===s))):this.setMenuIndex(-1),this.$emit("update:list-index",this.$refs.menu.listIndex)}this.$nextTick((()=>{this.internalSearch&&(1===e.length||this.autoSelectFirst)&&(this.$refs.menu.getTiles(),this.autoSelectFirst&&e.length&&(this.setMenuIndex(0),this.$emit("update:list-index",this.$refs.menu.listIndex)))}))}},onInternalSearchChanged(){this.updateMenuDimensions()},updateMenuDimensions(){this.isMenuActive&&this.$refs.menu&&this.$refs.menu.updateDimensions()},changeSelectedIndex(e){this.searchIsDirty||(this.multiple&&e===i.Do.left?-1===this.selectedIndex?this.selectedIndex=this.selectedItems.length-1:this.selectedIndex--:this.multiple&&e===i.Do.right?this.selectedIndex>=this.selectedItems.length-1?this.selectedIndex=-1:this.selectedIndex++:e!==i.Do.backspace&&e!==i.Do["delete"]||this.deleteCurrentItem())},deleteCurrentItem(){const e=this.selectedIndex,t=this.selectedItems[e];if(!this.isInteractive||this.getDisabled(t))return;const s=this.selectedItems.length-1;if(-1===this.selectedIndex&&0!==s)return void(this.selectedIndex=s);const r=this.selectedItems.length,a=e!==r-1?e:e-1,n=this.selectedItems[a];n?this.selectItem(t):this.setValue(this.multiple?[]:null),this.selectedIndex=a},clearableCallback(){this.internalSearch=null,r.Z.options.methods.clearableCallback.call(this)},genInput(){const e=a.Z.options.methods.genInput.call(this);return e.data=(0,n.ZP)(e.data,{attrs:{"aria-activedescendant":(0,i.vO)(this.$refs.menu,"activeTile.id"),autocomplete:(0,i.vO)(e.data,"attrs.autocomplete","off")},domProps:{value:this.internalSearch}}),e},genInputSlot(){const e=r.Z.options.methods.genInputSlot.call(this);return e.data.attrs.role="combobox",e},genSelections(){return this.hasSlot||this.multiple?r.Z.options.methods.genSelections.call(this):[]},onClick(e){this.isInteractive&&(this.selectedIndex>-1?this.selectedIndex=-1:this.onFocus(),this.isAppendInner(e.target)||this.activateMenu())},onInput(e){if(this.selectedIndex>-1||!e.target)return;const t=e.target,s=t.value;t.value&&this.activateMenu(),this.multiple||""!==s||this.deleteCurrentItem(),this.internalSearch=s,this.badInput=t.validity&&t.validity.badInput},onKeyDown(e){const t=e.keyCode;!e.ctrlKey&&[i.Do.home,i.Do.end].includes(t)||r.Z.options.methods.onKeyDown.call(this,e),this.changeSelectedIndex(t)},onSpaceDown(e){},onTabDown(e){r.Z.options.methods.onTabDown.call(this,e),this.updateSelf()},onUpDown(e){e.preventDefault(),this.activateMenu()},selectItem(e){r.Z.options.methods.selectItem.call(this,e),this.setSearch()},setSelectedItems(){r.Z.options.methods.setSelectedItems.call(this),this.isFocused||this.setSearch()},setSearch(){this.$nextTick((()=>{this.multiple&&this.internalSearch&&this.isMenuActive||(this.internalSearch=!this.selectedItems.length||this.multiple||this.hasSlot?null:this.getText(this.selectedItem))}))},updateSelf(){(this.searchIsDirty||this.internalValue)&&(this.multiple||this.valueComparator(this.internalSearch,this.getValue(this.internalValue))||this.setSearch())},hasItem(e){return this.selectedValues.indexOf(this.getValue(e))>-1},onCopy(e){var t,s;if(-1===this.selectedIndex)return;const r=this.selectedItems[this.selectedIndex],a=this.getText(r);null===(t=e.clipboardData)||void 0===t||t.setData("text/plain",a),null===(s=e.clipboardData)||void 0===s||s.setData("text/vnd.vuetify.autocomplete.item+plain",a),e.preventDefault()}}})}}]);
//# sourceMappingURL=8511.b7dbfe71.js.map